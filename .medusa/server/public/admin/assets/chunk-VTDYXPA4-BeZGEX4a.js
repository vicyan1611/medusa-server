import{I as qe}from"./chunk-PYIO3TDQ-D8Zv8hXV.js";import{g as T}from"./chunk-PDWBYQOW-BedvhUOI.js";import{D as Ke,I as ie,h as pe,e as Be,f as We,g as Ge,a as me}from"./chunk-53RYGJCD-D0AEtixK.js";import{c as Ue}from"./chunk-MWVM4TYO-bKUcYSnf.js";import{c as P}from"./chunk-6GU6IDUA-CDc7wW5L.js";import{K as He}from"./chunk-6HTZNHPT-DvJwJSO4.js";import{S as A}from"./chunk-4TC5YS65-PNQ5CA-G.js";import{r as u,j as o,bB as Xe,cJ as Ze,ex as fe,aM as w,bZ as Ye,b7 as Je,b8 as Qe,b9 as et,a6 as x,bn as M,b as z,co as tt,a8 as nt,a9 as ot,y as st,w as _,H as rt,T as F,B as H,m as he,I as J,b4 as it,D as k,W as at,X as lt,v as $,V as ct,bc as dt,z as X,Y as I,C as ut}from"./index-B25bhJz7.js";import{f as te,C as pt}from"./index.esm-DXhM25VB.js";import{X as mt}from"./x-mark-mini-B1LpjzJu.js";import{T as Z}from"./Trans-DS2tWNcH.js";import{C as V}from"./currency-input-CTC4p_Bg.js";var ft=Object.defineProperty,q=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable,ae=(e,n,t)=>n in e?ft(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,ht=(e,n)=>{for(var t in n)ge.call(n,t)&&ae(e,t,n[t]);if(q)for(var t of q(n))xe.call(n,t)&&ae(e,t,n[t]);return e},gt=(e,n)=>{var t={};for(var s in e)ge.call(e,s)&&n.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&q)for(var s of q(e))n.indexOf(s)<0&&xe.call(e,s)&&(t[s]=e[s]);return t};const ve=u.forwardRef((e,n)=>{var t=e,{color:s="currentColor"}=t,r=gt(t,["color"]);return u.createElement("svg",ht({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},r),u.createElement("path",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.056 1.944h4v4M13.056 1.944l-4 4M1.944 9.056v4h4M1.944 13.056l4-4"}))});ve.displayName="ArrowsPointingOut";var xt=Object.defineProperty,K=Object.getOwnPropertySymbols,be=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable,le=(e,n,t)=>n in e?xt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,vt=(e,n)=>{for(var t in n)be.call(n,t)&&le(e,t,n[t]);if(K)for(var t of K(n))je.call(n,t)&&le(e,t,n[t]);return e},bt=(e,n)=>{var t={};for(var s in e)be.call(e,s)&&n.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&K)for(var s of K(e))n.indexOf(s)<0&&je.call(e,s)&&(t[s]=e[s]);return t};const Ce=u.forwardRef((e,n)=>{var t=e,{color:s="currentColor"}=t,r=bt(t,["color"]);return u.createElement("svg",vt({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},r),u.createElement("path",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7.5 13.945a6.444 6.444 0 1 0 0-12.89 6.444 6.444 0 0 0 0 12.89M8.167 5.5h2.666M4.167 5.5h1.777M5.944 3.944v3.111M9.056 9.5h1.777M4.167 9.5h2.666M9.056 7.944v3.111"}))});Ce.displayName="CircleSliders";function jt(e,n=[]){let t=[];function s(i,a){const l=u.createContext(a),c=t.length;t=[...t,a];const d=p=>{var N;const{scope:m,children:g,...h}=p,v=((N=m==null?void 0:m[e])==null?void 0:N[c])||l,C=u.useMemo(()=>h,Object.values(h));return o.jsx(v.Provider,{value:C,children:g})};d.displayName=i+"Provider";function f(p,m){var v;const g=((v=m==null?void 0:m[e])==null?void 0:v[c])||l,h=u.useContext(g);if(h)return h;if(a!==void 0)return a;throw new Error(`\`${p}\` must be used within \`${i}\``)}return[d,f]}const r=()=>{const i=t.map(a=>u.createContext(a));return function(l){const c=(l==null?void 0:l[e])||i;return u.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return r.scopeName=e,[s,Ct(r,...n)]}function Ct(...e){const n=e[0];if(e.length===1)return n;const t=()=>{const s=e.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const a=s.reduce((l,{useScope:c,scopeName:d})=>{const p=c(i)[`__scope${d}`];return{...l,...p}},{});return u.useMemo(()=>({[`__scope${n.scopeName}`]:a}),[a])}};return t.scopeName=n.scopeName,t}function ce(e,n){if(typeof e=="function")return e(n);e!=null&&(e.current=n)}function ye(...e){return n=>{let t=!1;const s=e.map(r=>{const i=ce(r,n);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():ce(e[r],null)}}}}function yt(...e){return u.useCallback(ye(...e),e)}function _t(e,n,{checkForDefaultPrevented:t=!0}={}){return function(r){if(e==null||e(r),t===!1||!r.defaultPrevented)return n==null?void 0:n(r)}}function _e(e){const n=u.useRef(e);return u.useEffect(()=>{n.current=e}),u.useMemo(()=>(...t)=>{var s;return(s=n.current)==null?void 0:s.call(n,...t)},[])}function we({prop:e,defaultProp:n,onChange:t=()=>{}}){const[s,r]=wt({defaultProp:n,onChange:t}),i=e!==void 0,a=i?e:s,l=_e(t),c=u.useCallback(d=>{if(i){const p=typeof d=="function"?d(e):d;p!==e&&l(p)}else r(d)},[i,e,r,l]);return[a,c]}function wt({defaultProp:e,onChange:n}){const t=u.useState(e),[s]=t,r=u.useRef(s),i=_e(n);return u.useEffect(()=>{r.current!==s&&(i(s),r.current=s)},[s,r,i]),t}var Pe=u.forwardRef((e,n)=>{const{children:t,...s}=e,r=u.Children.toArray(t),i=r.find(Nt);if(i){const a=i.props.children,l=r.map(c=>c===i?u.Children.count(a)>1?u.Children.only(null):u.isValidElement(a)?a.props.children:null:c);return o.jsx(Q,{...s,ref:n,children:u.isValidElement(a)?u.cloneElement(a,void 0,l):null})}return o.jsx(Q,{...s,ref:n,children:t})});Pe.displayName="Slot";var Q=u.forwardRef((e,n)=>{const{children:t,...s}=e;if(u.isValidElement(t)){const r=St(t);return u.cloneElement(t,{...Ot(s,t.props),ref:n?ye(n,r):r})}return u.Children.count(t)>1?u.Children.only(null):null});Q.displayName="SlotClone";var Pt=({children:e})=>o.jsx(o.Fragment,{children:e});function Nt(e){return u.isValidElement(e)&&e.type===Pt}function Ot(e,n){const t={...n};for(const s in n){const r=e[s],i=n[s];/^on[A-Z]/.test(s)?r&&i?t[s]=(...l)=>{i(...l),r(...l)}:r&&(t[s]=r):s==="style"?t[s]={...r,...i}:s==="className"&&(t[s]=[r,i].filter(Boolean).join(" "))}return{...e,...t}}function St(e){var s,r;let n=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,t=n&&"isReactWarning"in n&&n.isReactWarning;return t?e.ref:(n=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,t=n&&"isReactWarning"in n&&n.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}var Rt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ne=Rt.reduce((e,n)=>{const t=u.forwardRef((s,r)=>{const{asChild:i,...a}=s,l=i?Pe:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(l,{...a,ref:r})});return t.displayName=`Primitive.${n}`,{...e,[n]:t}},{}),At=globalThis!=null&&globalThis.document?u.useLayoutEffect:()=>{},It=Xe.useId||(()=>{}),kt=0;function Et(e){const[n,t]=u.useState(It());return At(()=>{t(s=>s??String(kt++))},[e]),n?`radix-${n}`:""}var O="Accordion",Lt=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[ne,Tt,Mt]=Ze(O),[W,_n]=jt(O,[Mt,fe]),oe=fe(),Oe=w.forwardRef((e,n)=>{const{type:t,...s}=e,r=s,i=s;return o.jsx(ne.Provider,{scope:e.__scopeAccordion,children:t==="multiple"?o.jsx(zt,{...i,ref:n}):o.jsx($t,{...r,ref:n})})});Oe.displayName=O;var[Se,Vt]=W(O),[Re,Dt]=W(O,{collapsible:!1}),$t=w.forwardRef((e,n)=>{const{value:t,defaultValue:s,onValueChange:r=()=>{},collapsible:i=!1,...a}=e,[l,c]=we({prop:t,defaultProp:s,onChange:r});return o.jsx(Se,{scope:e.__scopeAccordion,value:l?[l]:[],onItemOpen:c,onItemClose:w.useCallback(()=>i&&c(""),[i,c]),children:o.jsx(Re,{scope:e.__scopeAccordion,collapsible:i,children:o.jsx(Ae,{...a,ref:n})})})}),zt=w.forwardRef((e,n)=>{const{value:t,defaultValue:s,onValueChange:r=()=>{},...i}=e,[a=[],l]=we({prop:t,defaultProp:s,onChange:r}),c=w.useCallback(f=>l((p=[])=>[...p,f]),[l]),d=w.useCallback(f=>l((p=[])=>p.filter(m=>m!==f)),[l]);return o.jsx(Se,{scope:e.__scopeAccordion,value:a,onItemOpen:c,onItemClose:d,children:o.jsx(Re,{scope:e.__scopeAccordion,collapsible:!0,children:o.jsx(Ae,{...i,ref:n})})})}),[Ft,G]=W(O),Ae=w.forwardRef((e,n)=>{const{__scopeAccordion:t,disabled:s,dir:r,orientation:i="vertical",...a}=e,l=w.useRef(null),c=yt(l,n),d=Tt(t),p=Ye(r)==="ltr",m=_t(e.onKeyDown,g=>{var E;if(!Lt.includes(g.key))return;const h=g.target,v=d().filter(L=>{var re;return!((re=L.ref.current)!=null&&re.disabled)}),C=v.findIndex(L=>L.ref.current===h),N=v.length;if(C===-1)return;g.preventDefault();let y=C;const b=0,S=N-1,j=()=>{y=C+1,y>S&&(y=b)},R=()=>{y=C-1,y<b&&(y=S)};switch(g.key){case"Home":y=b;break;case"End":y=S;break;case"ArrowRight":i==="horizontal"&&(p?j():R());break;case"ArrowDown":i==="vertical"&&j();break;case"ArrowLeft":i==="horizontal"&&(p?R():j());break;case"ArrowUp":i==="vertical"&&R();break}const U=y%N;(E=v[U].ref.current)==null||E.focus()});return o.jsx(Ft,{scope:t,disabled:s,direction:r,orientation:i,children:o.jsx(ne.Slot,{scope:t,children:o.jsx(Ne.div,{...a,"data-orientation":i,ref:c,onKeyDown:s?void 0:m})})})}),B="AccordionItem",[qt,se]=W(B),Ie=w.forwardRef((e,n)=>{const{__scopeAccordion:t,value:s,...r}=e,i=G(B,t),a=Vt(B,t),l=oe(t),c=Et(),d=s&&a.value.includes(s)||!1,f=i.disabled||e.disabled;return o.jsx(qt,{scope:t,open:d,disabled:f,triggerId:c,children:o.jsx(Je,{"data-orientation":i.orientation,"data-state":Me(d),...l,...r,ref:n,disabled:f,open:d,onOpenChange:p=>{p?a.onItemOpen(s):a.onItemClose(s)}})})});Ie.displayName=B;var ke="AccordionHeader",Kt=w.forwardRef((e,n)=>{const{__scopeAccordion:t,...s}=e,r=G(O,t),i=se(ke,t);return o.jsx(Ne.h3,{"data-orientation":r.orientation,"data-state":Me(i.open),"data-disabled":i.disabled?"":void 0,...s,ref:n})});Kt.displayName=ke;var ee="AccordionTrigger",Ee=w.forwardRef((e,n)=>{const{__scopeAccordion:t,...s}=e,r=G(O,t),i=se(ee,t),a=Dt(ee,t),l=oe(t);return o.jsx(ne.ItemSlot,{scope:t,children:o.jsx(Qe,{"aria-disabled":i.open&&!a.collapsible||void 0,"data-orientation":r.orientation,id:i.triggerId,...l,...s,ref:n})})});Ee.displayName=ee;var Le="AccordionContent",Te=w.forwardRef((e,n)=>{const{__scopeAccordion:t,...s}=e,r=G(O,t),i=se(Le,t),a=oe(t);return o.jsx(et,{role:"region","aria-labelledby":i.triggerId,"data-orientation":r.orientation,...a,...s,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});Te.displayName=Le;function Me(e){return e?"open":"closed"}var Bt=Oe,Wt=Ie,Gt=Ee,Ut=Te,Ht=(e,n,t)=>({attribute:e,operator:n,value:P(t)}),wn=e=>[{value:e.gte,operator:"gte"},{value:e.lte,operator:"lte"},{value:e.gt,operator:"gt"},{value:e.lt,operator:"lt"},{value:e.eq,operator:"eq"}].filter(({value:s})=>s).map(({operator:s,value:r})=>Ht(qe,s,r)),Ve=x.object({amount:x.union([x.string(),x.number()]),gte:x.union([x.string(),x.number()]).nullish(),lte:x.union([x.string(),x.number()]).nullish(),lt:x.number().nullish(),gt:x.number().nullish(),eq:x.number().nullish()}).refine(e=>e.amount!=="",{message:M("stockLocations.shippingOptions.conditionalPrices.errors.amountRequired"),path:["amount"]}).refine(e=>e.eq!==void 0||e.lt!==void 0||e.gt!==void 0?!0:e.gte!==void 0&&e.gte!==""||e.lte!==void 0&&e.lte!=="",{message:M("stockLocations.shippingOptions.conditionalPrices.errors.minOrMaxRequired"),path:["gte"]}).refine(e=>{if(e.gte!=null&&e.gte!==""&&e.lte!=null&&e.lte!==""){const n=P(e.gte),t=P(e.lte);return n<=t}return!0},{message:M("stockLocations.shippingOptions.conditionalPrices.errors.minGreaterThanMax"),path:["gte"]}),Xt=Ve.and(x.object({id:x.string().optional()}));function De(e,n){const t=e.prices;for(let s=0;s<t.length;s++)for(let r=s+1;r<t.length;r++){const i=t[s],a=t[r];if(i.amount===""||a.amount==="")continue;const l=P(i.amount),c=P(a.amount);l===c&&Jt(n,r),[{value:i.gte,type:"gte"},{value:i.lte,type:"lte"},{value:i.eq,type:"eq"},{value:i.lt,type:"lt"},{value:i.gt,type:"gt"}].forEach(f=>{if(!f.value&&f.value!==0)return;[{value:a.gte,type:"gte"},{value:a.lte,type:"lte"},{value:a.eq,type:"eq"},{value:a.lt,type:"lt"},{value:a.gt,type:"gt"}].forEach(m=>{if(!m.value&&m.value!==0)return;const g=P(f.value),h=P(m.value);g===h&&Qt(n,r,m.type)})})}}var Zt=x.object({prices:x.array(Ve)}).superRefine(De),Yt=x.object({prices:x.array(Xt)}).superRefine(De),Jt=(e,n)=>{e.addIssue({code:x.ZodIssueCode.custom,message:M("stockLocations.shippingOptions.conditionalPrices.errors.duplicateAmount"),path:["prices",n,"amount"]})},Qt=(e,n,t)=>{e.addIssue({code:x.ZodIssueCode.custom,message:M("stockLocations.shippingOptions.conditionalPrices.errors.overlappingConditions"),path:["prices",n,t]})},$e=u.createContext(null),Pn=({children:e,onOpenConditionalPricesModal:n,onCloseConditionalPricesModal:t})=>o.jsx($e.Provider,{value:{onOpenConditionalPricesModal:n,onCloseConditionalPricesModal:t},children:e}),ze=()=>{const e=u.useContext($e);if(!e)throw new Error("useShippingOptionPrice must be used within a ShippingOptionPriceProvider");return e},Fe=(e,n)=>{const t=n==="region"?"region_prices":"currency_prices",s=n==="region"?"conditional_region_prices":"conditional_currency_prices";return e.replace(t,s)},en="rule-item",D=e=>`${en}-${e}`,Nn=({info:e,variant:n})=>{const{t}=z(),{getValues:s,setValue:r}=tt(),{onCloseConditionalPricesModal:i}=ze(),[a,l]=u.useState([D(0)]),{field:c,type:d,currency:f,name:p}=e,m=Fe(c,d),g=nt({defaultValues:{prices:s(m)||[{amount:"",gte:"",lte:null}]},resolver:ot(n==="create"?Zt:Yt)}),{fields:h,append:v,remove:C}=st({control:g.control,name:"prices"}),N=()=>{v({amount:"",gte:"",lte:null}),l([...a,D(h.length)])},y=j=>{C(j)},b=g.handleSubmit(j=>{r(m,j.prices,{shouldDirty:!0,shouldValidate:!0,shouldTouch:!0}),i()},j=>{const R=Object.keys(j.prices||{});l(U=>{const E=new Set(U);return R.forEach(L=>{E.add(D(Number(L)))}),Array.from(E)})}),S=j=>{j.key==="Enter"&&(j.metaKey||j.ctrlKey)&&(console.log("Fired"),j.preventDefault(),j.stopPropagation(),b())};return o.jsx(_,{...g,children:o.jsx(He,{onSubmit:b,onKeyDown:S,className:"flex h-full flex-col",children:o.jsxs(A.Content,{children:[o.jsx(A.Header,{}),o.jsx(A.Body,{className:"size-full overflow-hidden",children:o.jsx("div",{className:"flex size-full flex-1 flex-col items-center overflow-y-auto",children:o.jsx("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8 px-6 py-16",children:o.jsxs("div",{className:"flex w-full flex-col gap-y-6",children:[o.jsxs("div",{children:[o.jsx(A.Title,{asChild:!0,children:o.jsx(rt,{children:t("stockLocations.shippingOptions.conditionalPrices.header",{name:p})})}),o.jsx(A.Description,{asChild:!0,children:o.jsx(F,{size:"small",className:"text-ui-fg-subtle",children:t("stockLocations.shippingOptions.conditionalPrices.description")})})]}),o.jsx(tn,{value:a,onValueChange:l,children:h.map((j,R)=>o.jsx(nn,{index:R,onRemove:y,currency:f,control:g.control},j.id))}),o.jsx("div",{className:"flex items-center justify-end",children:o.jsx(H,{variant:"secondary",size:"small",type:"button",onClick:N,children:t("stockLocations.shippingOptions.conditionalPrices.actions.addPrice")})})]})})})}),o.jsx(A.Footer,{children:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsx(A.Close,{asChild:!0,children:o.jsx(H,{variant:"secondary",size:"small",type:"button",children:t("actions.cancel")})}),o.jsx(H,{size:"small",type:"button",onClick:b,children:t("actions.save")})]})})]})})})},tn=({children:e,value:n,onValueChange:t})=>o.jsx(Bt,{type:"multiple",defaultValue:[D(0)],value:n,onValueChange:t,className:"flex flex-col gap-y-3",children:e}),nn=({index:e,currency:n,onRemove:t,control:s})=>{const{t:r}=z(),i=a=>{a.stopPropagation(),t(e)};return o.jsxs(Wt,{value:D(e),className:he("bg-ui-bg-component shadow-elevation-card-rest rounded-lg"),children:[o.jsx(Gt,{asChild:!0,children:o.jsxs("div",{className:"group/trigger flex w-full cursor-pointer items-start justify-between gap-x-2 p-3",children:[o.jsxs("div",{className:"flex flex-1 flex-wrap items-center justify-between gap-2",children:[o.jsx("div",{className:"flex h-7 items-center",children:o.jsx(sn,{index:e,currency:n,control:s})}),o.jsx("div",{className:"flex min-h-7 items-center",children:o.jsx(rn,{index:e,currency:n,control:s})})]}),o.jsxs("div",{className:"flex items-center gap-x-2",children:[o.jsx(J,{size:"small",variant:"transparent",className:"text-ui-fg-muted hover:text-ui-fg-subtle focus-visible:text-ui-fg-subtle",onClick:i,children:o.jsx(mt,{})}),o.jsx(J,{size:"small",variant:"transparent",className:"text-ui-fg-muted hover:text-ui-fg-subtle focus-visible:text-ui-fg-subtle",children:o.jsx(it,{className:"transition-transform group-data-[state=open]/trigger:rotate-180"})})]})]})}),o.jsxs(Ut,{className:"text-ui-fg-subtle",children:[o.jsx(k,{variant:"dashed"}),o.jsx(_.Field,{control:s,name:`prices.${e}.amount`,render:({field:{value:a,onChange:l,...c}})=>o.jsx(_.Item,{children:o.jsxs("div",{className:"grid grid-cols-2 items-start gap-x-2 p-3",children:[o.jsx("div",{className:"flex h-8 items-center",children:o.jsx(_.Label,{children:r("stockLocations.shippingOptions.conditionalPrices.rules.amount")})}),o.jsxs("div",{className:"flex flex-col gap-y-1",children:[o.jsx(_.Control,{children:o.jsx(V,{className:"bg-ui-bg-field-component hover:bg-ui-bg-field-component-hover focus-visible:bg-ui-bg-field-component-hover",placeholder:te({value:"0",decimalScale:n.decimal_digits}),decimalScale:n.decimal_digits,symbol:n.symbol_native,code:n.code,value:a,onValueChange:(d,f,p)=>l(p!=null&&p.value?p==null?void 0:p.value:""),autoFocus:!0,...c})}),o.jsx(_.ErrorMessage,{})]})]})})}),o.jsx(k,{variant:"dashed"}),o.jsx(_.Field,{control:s,name:`prices.${e}.gte`,render:({field:a})=>o.jsx(de,{field:a,label:r("stockLocations.shippingOptions.conditionalPrices.rules.gte"),currency:n,placeholder:"1000"})}),o.jsx(k,{variant:"dashed"}),o.jsx(_.Field,{control:s,name:`prices.${e}.lte`,render:({field:a})=>o.jsx(de,{field:a,label:r("stockLocations.shippingOptions.conditionalPrices.rules.lte"),currency:n,placeholder:"1000"})}),o.jsx(on,{index:e,control:s,currency:n})]})]})},de=({field:e,label:n,currency:t,placeholder:s})=>{const r=u.useRef(null),{value:i,onChange:a,ref:l,...c}=e,d=pe(r,l),f=()=>{if(i===null){a(""),requestAnimationFrame(()=>{var m;(m=r.current)==null||m.focus()});return}a(null)},p=i===null;return o.jsx(_.Item,{children:o.jsxs("div",{className:"grid grid-cols-2 items-start gap-x-2 p-3",children:[o.jsxs("div",{className:"flex h-8 items-center gap-x-1",children:[o.jsx(J,{size:"2xsmall",variant:"transparent",onClick:f,children:p?o.jsx(at,{}):o.jsx(lt,{})}),o.jsx(_.Label,{children:n})]}),!p&&o.jsxs("div",{className:"flex flex-col gap-y-1",children:[o.jsx(_.Control,{children:o.jsx(V,{className:"bg-ui-bg-field-component hover:bg-ui-bg-field-component-hover focus-visible:bg-ui-bg-field-component-hover",placeholder:te({value:s,decimalScale:t.decimal_digits}),decimalScale:t.decimal_digits,symbol:t.symbol_native,code:t.code,value:i,ref:d,onValueChange:(m,g,h)=>a(h!=null&&h.value?h==null?void 0:h.value:""),...c})}),o.jsx(_.ErrorMessage,{})]})]})})},on=({index:e,control:n,currency:t})=>{const{t:s}=z(),r=$({control:n,name:`prices.${e}`});return r.eq==null&&r.gt==null&&r.lt==null?null:o.jsxs("div",{children:[o.jsx(k,{variant:"dashed"}),o.jsxs("div",{className:"flex items-center gap-x-1 px-3 pt-3",children:[o.jsx(F,{size:"small",leading:"compact",weight:"plus",children:s("stockLocations.shippingOptions.conditionalPrices.customRules.label")}),o.jsx(ct,{content:s("stockLocations.shippingOptions.conditionalPrices.customRules.tooltip"),children:o.jsx(dt,{className:"text-ui-fg-muted"})})]}),o.jsxs("div",{children:[r.eq!=null&&o.jsxs("div",{className:"grid grid-cols-2 items-start gap-x-2 p-3",children:[o.jsx("div",{className:"flex h-8 items-center",children:o.jsx(X,{weight:"plus",size:"small",children:s("stockLocations.shippingOptions.conditionalPrices.customRules.eq")})}),o.jsx(V,{className:"bg-ui-bg-field-component hover:bg-ui-bg-field-component-hover focus-visible:bg-ui-bg-field-component-hover",symbol:t.symbol_native,code:t.code,value:r.eq,disabled:!0})]}),r.gt!=null&&o.jsxs(u.Fragment,{children:[o.jsx(k,{variant:"dashed"}),o.jsxs("div",{className:"grid grid-cols-2 items-start gap-x-2 p-3",children:[o.jsx("div",{className:"flex h-8 items-center",children:o.jsx(X,{weight:"plus",size:"small",children:s("stockLocations.shippingOptions.conditionalPrices.customRules.gt")})}),o.jsx(V,{className:"bg-ui-bg-field-component hover:bg-ui-bg-field-component-hover focus-visible:bg-ui-bg-field-component-hover",symbol:t.symbol_native,code:t.code,value:r.gt,disabled:!0})]})]}),r.lt!=null&&o.jsxs(u.Fragment,{children:[o.jsx(k,{variant:"dashed"}),o.jsxs("div",{className:"grid grid-cols-2 items-start gap-x-2 p-3",children:[o.jsx("div",{className:"flex h-8 items-center",children:o.jsx(X,{weight:"plus",size:"small",children:s("stockLocations.shippingOptions.conditionalPrices.customRules.lt")})}),o.jsx(V,{className:"bg-ui-bg-field-component hover:bg-ui-bg-field-component-hover focus-visible:bg-ui-bg-field-component-hover",symbol:t.symbol_native,code:t.code,value:r.lt,disabled:!0})]})]})]})]})},sn=({index:e,currency:n,control:t})=>{const s=$({control:t,name:`prices.${e}.amount`});if(s===""||s===void 0)return o.jsx(F,{size:"small",weight:"plus",children:"-"});const r=P(s);return o.jsx(F,{size:"small",weight:"plus",children:T(r,n.code)})},Y=({children:e})=>o.jsx("div",{className:"text-ui-fg-subtle txt-small flex flex-wrap items-center gap-1.5",children:e}),rn=({index:e,currency:n,control:t})=>{const{t:s,i18n:r}=z(),i=$({control:t,name:`prices.${e}.gte`}),a=$({control:t,name:`prices.${e}.lte`});return(()=>{const c=i?P(i):void 0,d=a?P(a):void 0;return!c&&!d?null:c&&!d?o.jsx(Y,{children:o.jsx(Z,{i18n:r,i18nKey:"stockLocations.shippingOptions.conditionalPrices.summaries.greaterThan",components:[o.jsx(I,{size:"2xsmall"},"attribute"),o.jsx(I,{size:"2xsmall"},"gte")],values:{attribute:s("stockLocations.shippingOptions.conditionalPrices.attributes.cartItemTotal"),gte:T(c,n.code)}})}):!c&&d?o.jsx(Y,{children:o.jsx(Z,{i18n:r,i18nKey:"stockLocations.shippingOptions.conditionalPrices.summaries.lessThan",components:[o.jsx(I,{size:"2xsmall"},"attribute"),o.jsx(I,{size:"2xsmall"},"lte")],values:{attribute:s("stockLocations.shippingOptions.conditionalPrices.attributes.cartItemTotal"),lte:T(d,n.code)}})}):c&&d?o.jsx(Y,{children:o.jsx(Z,{i18n:r,i18nKey:"stockLocations.shippingOptions.conditionalPrices.summaries.range",components:[o.jsx(I,{size:"2xsmall"},"attribute"),o.jsx(I,{size:"2xsmall"},"gte"),o.jsx(I,{size:"2xsmall"},"lte")],values:{attribute:s("stockLocations.shippingOptions.conditionalPrices.attributes.cartItemTotal"),gte:T(c,n.code),lte:T(d,n.code)}})}):null})()},ue=({context:e,code:n,header:t,type:s})=>{const[r,i]=u.useState(0),a=u.useCallback(v=>{if(v){const C=v.offsetWidth;i(C)}},[]),{field:l,control:c,renderProps:d}=Be({context:e}),f=We({context:e}),{container:p,input:m}=d,{isAnchor:g}=p,h=Ue[n.toUpperCase()];return o.jsx(ut,{control:c,name:l,render:({field:v})=>o.jsx(Ge,{...p,...f,outerComponent:o.jsx(an,{header:t,isAnchor:g,field:l,control:c,symbolWidth:r,type:s,currency:h}),children:o.jsx(ln,{field:v,inputProps:m,currencyInfo:h,onMeasureSymbol:a})})})},an=({isAnchor:e,header:n,field:t,control:s,symbolWidth:r,type:i,currency:a})=>{const{onOpenConditionalPricesModal:l}=ze(),c=u.useRef(null),d=Fe(t,i),f=$({control:s,name:d});return u.useEffect(()=>{const p=m=>{var g;e&&(m.metaKey||m.ctrlKey)&&m.key.toLowerCase()==="b"&&(m.preventDefault(),(g=c.current)==null||g.click())};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[e]),o.jsxs("div",{className:"absolute inset-y-0 z-[3] flex w-fit items-center justify-center",style:{left:r?`${r+16+4}px`:void 0},children:[(f==null?void 0:f.length)>0&&!e&&o.jsx("div",{className:"flex size-[15px] items-center justify-center group-hover/container:hidden",children:o.jsx(Ce,{className:"text-ui-fg-interactive"})}),o.jsx("button",{ref:c,type:"button",className:he("hover:text-ui-fg-subtle text-ui-fg-muted transition-fg hidden size-[15px] items-center justify-center rounded-md bg-transparent group-hover/container:flex",{flex:e}),onClick:()=>l({type:i,field:t,currency:a,name:n}),children:o.jsx(ve,{})})]})},ln=({field:e,onMeasureSymbol:n,inputProps:t,currencyInfo:s})=>{const{value:r,onChange:i,onBlur:a,ref:l,...c}=e,{ref:d,onBlur:f,onFocus:p,onChange:m,...g}=t,h=u.useCallback(b=>{const S=typeof b=="number"?b.toString():b||"";return te({value:S,decimalScale:s.decimal_digits,disableGroupSeparators:!0,decimalSeparator:"."})},[s]),[v,C]=u.useState(r||""),N=(b,S,j)=>{if(!b){C("");return}C(b)};u.useEffect(()=>{let b=r;isNaN(Number(r))||(b=h(b)),C(b)},[r,h]);const y=pe(d,l);return o.jsxs("div",{className:"relative flex size-full items-center",children:[o.jsx("span",{className:"txt-compact-small text-ui-fg-muted pointer-events-none absolute left-0 w-fit min-w-4","aria-hidden":!0,ref:n,children:s.symbol_native}),o.jsx(pt,{...c,...g,ref:y,className:"txt-compact-small w-full flex-1 cursor-default appearance-none bg-transparent pl-[60px] text-right outline-none",value:v||void 0,onValueChange:N,formatValueOnBlur:!0,onBlur:()=>{a(),f(),m(v,r)},onFocus:p,decimalScale:s.decimal_digits,decimalsLimit:s.decimal_digits,autoComplete:"off",tabIndex:-1})]})},cn=me(),On=({name:e,currencies:n=[],regions:t=[],pricePreferences:s=[]})=>{const{t:r}=z();return u.useMemo(()=>[cn.column({id:"name",name:r("fields.name"),disableHiding:!0,header:r("fields.name"),cell:i=>o.jsx(Ke.ReadonlyCell,{context:i,children:e})}),...dn({currencies:n,regions:t,pricePreferences:s,getFieldName:(i,a)=>{var l;return(l=i.column.id)!=null&&l.startsWith("currency_prices")?`currency_prices.${a}`:`region_prices.${a}`},t:r})],[r,n,t,s,e])},dn=({currencies:e,regions:n,pricePreferences:t,getFieldName:s,t:r})=>{const i=me();return[...(e==null?void 0:e.map(a=>{const l=t==null?void 0:t.find(d=>d.attribute==="currency_code"&&d.value===a),c=r("fields.priceTemplate",{regionOrCurrency:a.toUpperCase()});return i.column({id:`currency_prices.${a}`,name:r("fields.priceTemplate",{regionOrCurrency:a.toUpperCase()}),field:d=>s(d,a),type:"number",header:()=>o.jsxs("div",{className:"flex w-full items-center justify-between gap-3",children:[o.jsx("span",{className:"truncate",title:c,children:c}),o.jsx(ie,{includesTax:l==null?void 0:l.is_tax_inclusive})]}),cell:d=>o.jsx(ue,{type:"currency",header:c,code:a,context:d})})}))??[],...(n==null?void 0:n.map(a=>{const l=t==null?void 0:t.find(d=>d.attribute==="region_id"&&d.value===a.id),c=r("fields.priceTemplate",{regionOrCurrency:a.name});return i.column({id:`region_prices.${a.id}`,name:r("fields.priceTemplate",{regionOrCurrency:a.name}),field:d=>s(d,a.id),type:"number",header:()=>o.jsxs("div",{className:"flex w-full items-center justify-between gap-3",children:[o.jsx("span",{className:"truncate",title:c,children:c}),o.jsx(ie,{includesTax:l==null?void 0:l.is_tax_inclusive})]}),cell:d=>(e==null?void 0:e.find(p=>p===a.currency_code))?o.jsx(ue,{type:"region",header:c,code:a.currency_code,context:d}):null})}))??[]]};export{Ve as C,Pn as S,Xt as U,Nn as a,wn as b,On as u};
